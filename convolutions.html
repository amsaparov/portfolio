
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FFT - Convolutions and Filtering &#8212; Alice&#39;s Projects</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Gradient Optimization" href="gradient_optimization.html" />
    <link rel="prev" title="Fuzzy Matching" href="fuzzy_matching.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/wave.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Alice's Projects</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   About Me
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="reference internal" href="content.html">
   Project Notebooks
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="LinReg_PCA.html">
     Linear Regression and PCA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Linear_Regression.html">
     Single and Multiple Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="UFOProject.html">
     UFO Group Project
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="data_cleaning.html">
     Data Cleaning and Investigation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ab_testing.html">
     A/B Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fuzzy_matching.html">
     Fuzzy Matching
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     FFT - Convolutions and Filtering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gradient_optimization.html">
     Gradient Optimization
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/convolutions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fconvolutions.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/convolutions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-my-own-convolution-function-for-2d-arrays">
   Creating my own convolution function for 2D arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wiener-filter">
   Wiener Filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lynx-hare-pelt-data">
   Lynx-Hare pelt data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eeg-data">
   EEG Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-band-pass-filter">
   Creating a band pass filter
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="fft-convolutions-and-filtering">
<h1>FFT - Convolutions and Filtering<a class="headerlink" href="#fft-convolutions-and-filtering" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">wiener</span> <span class="k">as</span> <span class="n">wiener</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-my-own-convolution-function-for-2d-arrays">
<h2>Creating my own convolution function for 2D arrays<a class="headerlink" href="#creating-my-own-convolution-function-for-2d-arrays" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convol_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span><span class="p">(</span><span class="s1">&#39;error, not 1D&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span><span class="p">(</span><span class="s1">&#39;error, not 1D&#39;</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;constant&#39;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;constant&#39;</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)):</span>
        <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">z</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#test my function </span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">convol_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;my function&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> np.convolve(x, y)
<span class="o">%</span><span class="k">timeit</span> convol_func(x, y)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>python [ 2  6 12 18 14  8]
my function [ 2.  6. 12. 18. 14.  8.]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.86 µs ± 37.5 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>207 µs ± 8.64 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
</div>
</div>
<p>The np.convolve function is computationally faster than my function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Exploring and smoothing synthetic noise data</span>

<span class="n">L</span> <span class="o">=</span> <span class="mi">512</span> <span class="c1"># length of signal</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="n">L</span>  <span class="c1"># sampling rate</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">Fs</span> <span class="c1"># sampling interval</span>
<span class="n">Max_time</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># duration of the signal</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Max_time</span><span class="p">,</span><span class="n">Ts</span><span class="p">)</span> <span class="c1"># time vector of length L</span>

<span class="c1"># generate a signal with different frequencies</span>
<span class="n">ff1</span> <span class="o">=</span> <span class="mi">100</span>   <span class="c1"># frequency 1 of the signal</span>
<span class="n">ff2</span> <span class="o">=</span> <span class="mi">50</span>   <span class="c1"># frequency 2 of the signal</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># weight of frequency 1</span>
<span class="n">w2</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># weight of frequency 2</span>
<span class="n">w3</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># weight of random noise</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">ff1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span> <span class="n">w2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">ff2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="c1"># add two sine waves</span>
<span class="n">signal_noise</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">+</span> <span class="n">w3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">L</span><span class="p">)</span> <span class="c1"># add normal noise</span>

<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">python</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">signal_noise</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<span class="n">my_func</span> <span class="o">=</span> <span class="n">convol_func</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">signal_noise</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All elements of the vector are closer than tolerance:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">python</span><span class="p">,</span> <span class="n">my_func</span><span class="p">))</span>
<span class="o">%</span><span class="k">timeit</span> np.convolve(signal_noise, kernel)
<span class="o">%</span><span class="k">timeit</span> convol_func(kernel, signal_noise)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All elements of the vector are closer than tolerance: True
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.88 µs ± 25.4 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.4 ms ± 76 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="wiener-filter">
<h2>Wiener Filter<a class="headerlink" href="#wiener-filter" title="Permalink to this headline">¶</a></h2>
<p>Comparing the smoothing filter and the Wiener filter for the purpose of removing additive normal noise</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># root mean sqared distance b/w noisy signal and original </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSD of Noisy signal:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">signal_noise</span> <span class="o">-</span> <span class="n">signal</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="n">signal_w</span> <span class="o">=</span> <span class="n">wiener</span><span class="p">(</span><span class="n">signal_noise</span><span class="p">,</span> <span class="n">mysize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># root mean sqared distance b/w wiener filtered signal and original </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSD of Wiener filtered signal:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">signal_w</span> <span class="o">-</span> <span class="n">signal</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> 

<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">signal_noise</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="c1"># root mean sqared distance b/w smooth filtered signal and original </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSD of Smooth filtered signal:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">smooth</span> <span class="o">-</span> <span class="n">signal</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMSD of Noisy signal: 12462.890616564884
RMSD of Wiener filtered signal: 5270.840046552425
RMSD of Smooth filtered signal: 4230.098417951445
</pre></div>
</div>
</div>
</div>
<p>The Wiener filter appears to perform worse in this case as seen by the higher RMSD (6443.65) compared to the smoothing filter which had an RMSD of 4984.42. This means the smoothing filter is closer/has less error from the orginal.</p>
</div>
<div class="section" id="lynx-hare-pelt-data">
<h2>Lynx-Hare pelt data<a class="headerlink" href="#lynx-hare-pelt-data" title="Permalink to this headline">¶</a></h2>
<p>The data set contains the number of pelts of lynx and hare sold by the Hudson bay company over time (years).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pelts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;pelt_data.csv&quot;</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">w_hare</span> <span class="o">=</span> <span class="n">wiener</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="n">mysize</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">w_lynx</span> <span class="o">=</span> <span class="n">wiener</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Lynx</span><span class="p">,</span> <span class="n">mysize</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="n">s_hare</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">s_lynx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Lynx</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>

<span class="c1">#wiener</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Hare&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">pelts</span><span class="o">.</span><span class="n">Lynx</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Lynx&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">w_hare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Wiener Hare&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">w_lynx</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Wiener Lynx&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;# of Pelts Sold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Pelts Sold v Year - Wiener Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#smoothing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Hare&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">pelts</span><span class="o">.</span><span class="n">Lynx</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Lynx&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">s_hare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Smooth Hare&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">s_lynx</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Smooth Lynx&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;# of Pelts Sold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Pelts Sold v Year - Smoothing Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/convolutions_11_0.png" src="_images/convolutions_11_0.png" />
<img alt="_images/convolutions_11_1.png" src="_images/convolutions_11_1.png" />
</div>
</div>
<p>A window size of 2 seems to fit the periodicity of the data best. A larger n (for example n=25) seems to obliterate the periodicity of the data as the lines are more flat/do not follow the data as well. Also, the smoothing filter looks more flat, so its periodicity is eliminated even more at higher n’s compared to the wiener filter. A smaller n of 1 does not work.</p>
</div>
<div class="section" id="eeg-data">
<h2>EEG Data<a class="headerlink" href="#eeg-data" title="Permalink to this headline">¶</a></h2>
<p>I am using the same two filters again (smoothing and Wiener) to explore denoising the EEG data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eeg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;extrait_wSleepPage01.csv&quot;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

<span class="c1">#only using the first 4096 rows</span>
<span class="n">eeg</span> <span class="o">=</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">]</span>

<span class="c1">#combining mintues and seconds into one &#39;time&#39; variable</span>
<span class="n">eeg</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">MM</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span> <span class="o">+</span> <span class="n">eeg</span><span class="o">.</span><span class="n">SS</span>
<span class="n">eeg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>HH</th>
      <th>MM</th>
      <th>SS</th>
      <th>EOG Left</th>
      <th>EEG C3-A1</th>
      <th>EEG O1-A1</th>
      <th>EEG C4-A1</th>
      <th>EEG O2-A1</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>08/03/2016</td>
      <td>1</td>
      <td>27</td>
      <td>22.000</td>
      <td>7.812500e-01</td>
      <td>5.566406</td>
      <td>-12.402344</td>
      <td>0.976562</td>
      <td>13.769531</td>
      <td>1642.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>08/03/2016</td>
      <td>1</td>
      <td>27</td>
      <td>22.005</td>
      <td>1.953125e+00</td>
      <td>4.785156</td>
      <td>-11.230469</td>
      <td>-0.097656</td>
      <td>17.089844</td>
      <td>1642.005</td>
    </tr>
    <tr>
      <th>2</th>
      <td>08/03/2016</td>
      <td>1</td>
      <td>27</td>
      <td>22.010</td>
      <td>-1.670000e-14</td>
      <td>4.296875</td>
      <td>-11.230469</td>
      <td>0.976562</td>
      <td>17.968750</td>
      <td>1642.010</td>
    </tr>
    <tr>
      <th>3</th>
      <td>08/03/2016</td>
      <td>1</td>
      <td>27</td>
      <td>22.015</td>
      <td>7.812500e-01</td>
      <td>4.785156</td>
      <td>-12.011719</td>
      <td>6.347656</td>
      <td>20.117188</td>
      <td>1642.015</td>
    </tr>
    <tr>
      <th>4</th>
      <td>08/03/2016</td>
      <td>1</td>
      <td>27</td>
      <td>22.020</td>
      <td>2.929688e-01</td>
      <td>4.101562</td>
      <td>-13.183594</td>
      <td>8.105469</td>
      <td>17.382812</td>
      <td>1642.020</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">w_c3a1</span> <span class="o">=</span> <span class="n">wiener</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">5</span><span class="p">],</span> <span class="n">mysize</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">w_01a1</span> <span class="o">=</span> <span class="n">wiener</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="n">mysize</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">w_c4a1</span> <span class="o">=</span> <span class="n">wiener</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">7</span><span class="p">],</span> <span class="n">mysize</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="n">w_o2a1</span> <span class="o">=</span> <span class="n">wiener</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">8</span><span class="p">],</span> <span class="n">mysize</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="n">s_c3a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">5</span><span class="p">],</span> <span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">s_01a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">s_c4a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">7</span><span class="p">],</span> <span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">s_o2a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">8</span><span class="p">],</span> <span class="n">kernel</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>

<span class="c1">#wiener</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">5</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;C3-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">w_c3a1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;w C3-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;EEG Signal over Time - Wiener Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;O1-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">w_01a1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;w O1-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;EEG Signal over Time - Wiener Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">7</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;C4-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">w_c4a1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;w C4-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;EEG Signal over Time - Wiener Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">8</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;O2-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">w_o2a1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;w O2-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;EEG Signal over Time - Wiener Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#smoothing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">5</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;C3-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">s_c3a1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;s C3-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;EEG Signal over Time - Smoothing Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;O1-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">s_01a1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;s O1-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;EEG Signal over Time - Smoothing Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">7</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;C4-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">s_c4a1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;s C4-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;EEG Signal over Time - Smoothing Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">eeg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">8</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;O2-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eeg</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">s_o2a1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;s O2-A1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EEG&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;EEG Signal over Time - Smoothing Filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/convolutions_15_0.png" src="_images/convolutions_15_0.png" />
<img alt="_images/convolutions_15_1.png" src="_images/convolutions_15_1.png" />
<img alt="_images/convolutions_15_2.png" src="_images/convolutions_15_2.png" />
<img alt="_images/convolutions_15_3.png" src="_images/convolutions_15_3.png" />
<img alt="_images/convolutions_15_4.png" src="_images/convolutions_15_4.png" />
<img alt="_images/convolutions_15_5.png" src="_images/convolutions_15_5.png" />
<img alt="_images/convolutions_15_6.png" src="_images/convolutions_15_6.png" />
<img alt="_images/convolutions_15_7.png" src="_images/convolutions_15_7.png" />
</div>
</div>
<p>At n=20, the level of smoothing seems helpful, but it still allows for the essential periodicity of the data to be seen. At very high n values, the wiener filter appears to maintain the periodicity of the data a lot better in comparison to the smoothing filter (smooths it out too much/more flat). At lower n values, the data is just not very smooth and resembles the original very closely.</p>
</div>
<div class="section" id="creating-a-band-pass-filter">
<h2>Creating a band pass filter<a class="headerlink" href="#creating-a-band-pass-filter" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bpf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;k too big&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">center</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">center</span> <span class="o">-</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">center</span> <span class="o">+</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">f_vec</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">left</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="n">right</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">vec_multiplied</span> <span class="o">=</span> <span class="n">ft</span><span class="o">*</span><span class="n">f_vec</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">vec_multiplied</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#k=30, good</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Hare&#39;</span><span class="p">)</span>
<span class="n">bphare</span> <span class="o">=</span> <span class="n">bpf</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">bphare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;BP filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;# of Pelts Sold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hare Pelts Sold v Year - k=30&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#k=40, too smooth</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Hare&#39;</span><span class="p">)</span>
<span class="n">bphare</span> <span class="o">=</span> <span class="n">bpf</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">bphare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;BP filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;# of Pelts Sold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hare Pelts Sold v Year - k=40&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#k=10, over fit </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Hare&#39;</span><span class="p">)</span>
<span class="n">bphare</span> <span class="o">=</span> <span class="n">bpf</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Hare</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pelts</span><span class="o">.</span><span class="n">Year</span><span class="p">,</span> <span class="n">bphare</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;BP filter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;# of Pelts Sold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Hare Pelts Sold v Year - k=10&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/convolutions_19_0.png" src="_images/convolutions_19_0.png" />
<img alt="_images/convolutions_19_1.png" src="_images/convolutions_19_1.png" />
<img alt="_images/convolutions_19_2.png" src="_images/convolutions_19_2.png" />
</div>
</div>
<p>For the Hare data, when k = 30 the band pass filter provides a nice smooth fit for the data without losing the periodicity. When k is very large (40), the filter oversmooths and a lot of the periodicity is lost. Then, when k is very small (10), the data is overfit/periodicity or spikes are created where there shouldn’t be any.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="fuzzy_matching.html" title="previous page">Fuzzy Matching</a>
    <a class='right-next' id="next-link" href="gradient_optimization.html" title="next page">Gradient Optimization</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Alice Saparov<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>